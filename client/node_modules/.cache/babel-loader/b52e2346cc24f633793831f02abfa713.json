{"ast":null,"code":"var _jsxFileName = \"/Users/ashianagi/Desktop/TechWorks/findyourjob/client/src/searchbar.js\";\nimport React from 'react';\nimport axios from \"axios\";\nlet skills = [];\nlet results = [];\n\nclass Search extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.onChangedEvent = e => {\n      let value = e.target.value; //capture the char as user types\n\n      value = value.toLowerCase();\n      let matches = []; //matching input value to stored data\n\n      if (value.length > 0) {\n        const regex = new RegExp(\"^\".concat(value));\n        matches = this.state.data.sort().filter(val => regex.test(val));\n      } //storing matched skills to matches and updating the state. \n\n\n      this.setState(() => ({\n        matches\n      }));\n    };\n\n    this.handleEnterKey = e => {\n      const matches = this.state.matches;\n\n      if (e.key === 'Enter' && matches.length > 0) {\n        skills.push(e.target.value);\n      } else if (e.key === 'Enter' && matches.length === 0) {\n        this.setState({\n          errorMessage: \"Skill does not exist in the database\"\n        });\n      } else if (e.key === 'Backspace') {\n        this.setState({\n          errorMessage: \"\"\n        });\n      }\n    };\n\n    this.fetchResults = async skills => {\n      let results = [];\n      skills.map(async function (skill) {\n        try {\n          const res = await axios.get(\"/api/results/\".concat(skill));\n          let resultsArray = res.data.map(result => result.jobs_name);\n          results = results.concat(resultsArray);\n          this.setState({\n            results: results\n          });\n          console.log(this.state.results, \"results\");\n        } catch (error) {\n          console.log(error);\n        }\n      }, this);\n    };\n\n    this.state = {\n      data: [],\n      //holds skills data\n      matches: [],\n      results,\n      skills,\n      //user skills\n      errorMessage: ''\n    };\n  } // fetching skills from database and updating it to data in state. \n\n\n  async componentDidMount() {\n    try {\n      const res = await axios.get(\"/api/skills\");\n      let skillsArray = res.data.map(skill => skill.skill_name);\n      this.setState({\n        data: skillsArray\n      });\n      console.log(res.data);\n    } catch (error) {\n      console.log(error);\n    }\n  } //matching input skill to skills stored in data\n\n\n  //outputs results of matched skills to user. \n  outputResults() {\n    const matches = this.state.matches;\n\n    if (matches.length === 0) {\n      return null;\n    }\n\n    return React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, matches.map(item => React.createElement(\"li\", {\n      key: item,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 56\n      },\n      __self: this\n    }, item)));\n  } //handling errors \n\n\n  compressArray(original) {\n    var compressed = [];\n    var copy = original.slice(0);\n\n    for (var i = 0; i < original.length; i++) {\n      var myCount = 0;\n\n      for (var w = 0; w < copy.length; w++) {\n        if (original[i] === copy[w]) {\n          myCount++;\n          delete copy[w];\n        }\n      }\n\n      if (myCount > 0) {\n        var a = {};\n        a.value = original[i];\n        a.count = myCount;\n        compressed.push(a);\n      }\n    }\n\n    compressed = compressed.sort((a, b) => a.count < b.count ? 1 : -1);\n    console.log(compressed);\n    return compressed;\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      onChange: this.onChangedEvent,\n      onKeyDown: e => this.handleEnterKey(e),\n      type: \"text\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }), this.outputResults(), this.state.errorMessage, React.createElement(\"button\", {\n      type: \"button\",\n      onClick: () => this.fetchResults(this.state.skills),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \" Search\"), React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, this.compressArray(this.state.results).map((item, index) => React.createElement(\"li\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, \" \", item.value, \" \"))));\n  }\n\n}\n\nexport default Search;","map":{"version":3,"sources":["/Users/ashianagi/Desktop/TechWorks/findyourjob/client/src/searchbar.js"],"names":["React","axios","skills","results","Search","Component","constructor","props","onChangedEvent","e","value","target","toLowerCase","matches","length","regex","RegExp","state","data","sort","filter","val","test","setState","handleEnterKey","key","push","errorMessage","fetchResults","map","skill","res","get","resultsArray","result","jobs_name","concat","console","log","error","componentDidMount","skillsArray","skill_name","outputResults","item","compressArray","original","compressed","copy","slice","i","myCount","w","a","count","b","render","index"],"mappings":"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","sourcesContent":["import React from 'react'; \nimport axios from \"axios\"; \n\nlet skills = []; \nlet results = []; \n\nclass Search extends React.Component {\n    constructor(props) {\n        super(props); \n        this.state = {\n            data: [], //holds skills data\n            matches: [], \n            results, \n            skills, //user skills\n            errorMessage: '',\n        } \n\n    }\n\n    // fetching skills from database and updating it to data in state. \n    async componentDidMount() {\n        try {\n            const res = await axios.get(\"/api/skills\")\n            let skillsArray = res.data.map(skill => skill.skill_name) \n            this.setState({\n                data: skillsArray,\n            })\n            console.log(res.data);\n        } catch(error){\n            console.log(error)\n        }\n    }\n\n    //matching input skill to skills stored in data\n    onChangedEvent = (e) => {\n        let value = e.target.value; //capture the char as user types\n        value = value.toLowerCase(); \n        let matches  = []; \n        //matching input value to stored data\n        if (value.length > 0) {\n            const regex = new RegExp(`^${value}`); \n            matches = this.state.data.sort().filter(val => regex.test(val))\n        }\n        //storing matched skills to matches and updating the state. \n       this.setState(()=> ({matches}));\n    }\n  \n    //outputs results of matched skills to user. \n    outputResults () {\n        const { matches } = this.state; \n        if (matches.length ===  0 ) {\n            return null; \n        } \n        return (\n            <ul> \n                {matches.map((item) => <li key={item}>{item}</li>)}\n            </ul>\n        )\n    }\n\n    //handling errors \n    handleEnterKey = (e) => {\n        const { matches } = this.state;\n        if(e.key === 'Enter' && matches.length > 0) {\n            skills.push(e.target.value); \n        } else if(e.key === 'Enter' && matches.length === 0) {\n            this.setState({\n                errorMessage: \"Skill does not exist in the database\"\n            })\n         } else if(e.key === 'Backspace') {\n            this.setState({\n                errorMessage: \"\"\n            })\n        }\n    }\n\n    fetchResults = async skills => {\n        let results = []; \n       skills.map(async function(skill) {\n            try {\n                const res = await axios.get(`/api/results/${skill}`); \n                let resultsArray = res.data.map(result => result.jobs_name);\n                results = results.concat(resultsArray); \n                this.setState({\n                    results: results\n                })\n                console.log(this.state.results, \"results\");\n            } catch(error) {\n                console.log(error);\n        }   }, this)\n    }\n\n    compressArray(original) {\n            var compressed = [];\n            var copy = original.slice(0);\n            for (var i = 0; i < original.length; i++) {\n                var myCount = 0;\t\n                for (var w = 0; w < copy.length; w++) {\n                    if (original[i] === copy[w]) {\n                        myCount++;\n                        delete copy[w];\n                    }\n                }\n                if (myCount > 0) {\n                    var a = {};\n                    a.value = original[i];\n                    a.count = myCount;\n                    compressed.push(a);\n                }\n            }\n            compressed = compressed.sort((a,b) => (a.count < b.count) ? 1: -1); \n            console.log(compressed); \n            return compressed;\n        }\n\n    render () {\n        return (\n            <div>  \n                <input onChange={this.onChangedEvent} onKeyDown={(e) => this.handleEnterKey(e)} type=\"text\"/> \n                {this.outputResults()}\n                {this.state.errorMessage} \n                <button type=\"button\" onClick={()=> this.fetchResults(this.state.skills)}> Search</button>\n                <ul> \n                    {this.compressArray(this.state.results).map((item, index) =>  <li key={index}> {item.value} </li>)}\n                    {/* {this.state.results.map((item, index) => <li key={index}> {item} </li>)} */}\n                </ul>\n            </div>\n        )\n    }\n}\nexport default Search; "]},"metadata":{},"sourceType":"module"}